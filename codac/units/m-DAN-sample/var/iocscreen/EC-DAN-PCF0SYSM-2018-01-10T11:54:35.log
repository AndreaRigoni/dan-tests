#!../../bin/linux-x86_64/EC-DAN
#+======================================================================
# $HeadURL: https://svnpub.iter.org/codac/iter/codac/dev/units/m-epics-iter-templates/tags/CODAC-CORE-5.4.0/templates/genericBoot/ioc/st.cmd $
# $Id: st.cmd 75208 2017-02-03 09:19:23Z cesnikt $
#
# Project       : CODAC Core System
#
# Description   : ITER ioc template EPICS start up file
#
# Author(s)     : This file was generated by CODAC development toolkit
#
# Copyright (c) : 2010-2017 ITER Organization,
#                 CS 90 046
#                 13067 St. Paul-lez-Durance Cedex
#                 France
#
# This file is part of ITER CODAC software.
# For the terms and conditions of redistribution or use of this software
# refer to the file ITER-LICENSE.TXT located in the top level directory
# of the distribution package.
#
#-======================================================================
< envPaths
epicsEnvSet("IOC","iocEC-DAN-PCF0SYSM")
epicsEnvSet("TOP","/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/target/main/epics")
epicsEnvSet("EPICS_BASE","/opt/codac-5.4/epics")
< envSystem
############################################################################
## CODAC specific environment variables
############################################################################
epicsEnvSet("AUTOSAVE_SYSM_PV_PREFIX","EC-DAN-SYSM:F0SYSM-")
epicsEnvSet("IOCSH_PS1","iocEC-DAN-PCF0SYSM> ")
epicsEnvSet("STREAM_PROTOCOL_PATH","/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/target/main/epics/db:/opt/codac-5.4/epics/db")
#- End-of-file marker - do not delete or add lines below!
< envUser
############################################################################
## User provided environment variables
############################################################################
#epicsEnvSet("EPICS_CA_SERVER_PORT", "5064")
#epicsEnvSet("EPICS_CA_ADDR_LIST", "")
#epicsEnvSet("EPICS_CA_AUTO_ADDR_LIST", "YES")
#- End-of-file marker - do not delete or add lines below!
cd "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/target/main/epics"
############################################################################
## Register all support components
############################################################################
dbLoadDatabase "dbd/EC-DAN.dbd"
EC_DAN_registerRecordDeviceDriver pdbbase
< "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/target/main/epics/iocBoot/iocEC-DAN-PCF0SYSM/sddPreDriverConf.cmd"
############################################################################
## SDD provided PLC or fast controller driver pre configuration
############################################################################
#- End-of-file marker - do not delete or add lines below!
< "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/target/main/epics/iocBoot/iocEC-DAN-PCF0SYSM/userPreDriverConf.cmd"
############################################################################
## User provided PLC or fast controller driver pre configuration
############################################################################
#- End-of-file marker - do not delete or add lines below!
< "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/target/main/epics/iocBoot/iocEC-DAN-PCF0SYSM/threadSchedulingConf.cmd"
############################################################################
## Thread scheduling configuration for real-time tuning
############################################################################
#- End-of-file marker - do not delete or add lines below!
< "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/target/main/epics/iocBoot/iocEC-DAN-PCF0SYSM/dbToLoad.cmd"
#======================================================================
# SYS Monitor
#======================================================================
cd /opt/codac-5.4/epics/db
dbLoadRecords("picmg-sensors.db","CBS=EC-DAN-, CTRLTYPE=F, IDX=0")
dbLoadRecords("sysmon.db","CBS=EC-DAN-, CTRLTYPE=F, IDX=0")
dbLoadRecords("picmg-cfa633.db","CBS=EC-DAN-, CTRLTYPE=F, IDX=0")
dbLoadRecords("sysmon-tcnd.db","CBS=EC-DAN-, CTRLTYPE=F, IDX=0")
#======================================================================
# IOC Monitor
#======================================================================
cd /opt/codac-5.4/epics/db
dbLoadRecords("iocmon.db","CBS=EC-DAN-, CTRLTYPE=F, IDX=0, IOCTYPE=SYSM")
#- End-of-file marker - do not delete or add lines below!
< "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/target/main/epics/iocBoot/iocEC-DAN-PCF0SYSM/iocEC-DAN-PCF0SYSM-preSaveRestore.cmd"
############################################################################
## Save and restore
############################################################################
### save_restore setup
# status-PV prefix
save_restoreSet_status_prefix("EC-DAN-SYSM:F0SYSM-")
# Use status-PV 
save_restoreSet_UseStatusPVs(1)
# Debug-output level
save_restoreSet_Debug(0)
# Ok to save/restore save sets with missing values (no CA connection to PV)?
save_restoreSet_IncompleteSetsOk(1)
# Save dated backup files?
save_restoreSet_DatedBackupFiles(1)
# Number of sequenced backup files to write
save_restoreSet_NumSeqFiles(3)
# Time interval between sequenced backups
save_restoreSet_SeqPeriodInSeconds(300)
# specify where save files should be
set_savefile_path("/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/autosave/")
# specify what save files should be restored.  Note these files must be
# in the directory specified in set_savefile_path(), or, if that function
# has not been called, from the directory current when iocInit is invoked
# Save files associated with the request files 'auto-output.req' and
# 'auto-input.req'.  These files are the standard way to use autosave 
 
set_pass1_restoreFile("iocEC-DAN-PCF0SYSM.sav")
# specify directories in which to to search for included request files
set_requestfile_path("./")
dbLoadRecords("/opt/codac-5.4/epics/db/save_restoreStatus.db", "P=EC-DAN-SYSM:F0SYSM-")
#- End-of-file marker - do not delete or add lines below!
############################################################################
## IOC Logging
############################################################################
iocLogInit
log client: connected to log server at "127.0.0.1:6500"
iocLogPrefix "12094.iocEC-DAN-PCF0SYSM : "
############################################################################
## IOC initialization
############################################################################
cd "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/target/main/epics/db"
Invalid directory path, ignored
iocInit
Starting iocInit
############################################################################
## EPICS R3.15.5
## EPICS Base built Feb 20 2017
############################################################################
reboot_restore: entry for file 'iocEC-DAN-PCF0SYSM.sav'
reboot_restore: Found filename 'iocEC-DAN-PCF0SYSM.sav' in restoreFileList.
*** restoring from '/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/autosave/iocEC-DAN-PCF0SYSM.sav' at initHookState 7 (after record/device init) ***
save_restore: Can't open file '/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/autosave/iocEC-DAN-PCF0SYSM.sav'.
save_restore: Trying backup file '/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/autosave/iocEC-DAN-PCF0SYSM.savB'
save_restore: Can't open file '/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/autosave/iocEC-DAN-PCF0SYSM.savB'.
save_restore: Can't figure out which seq file is most recent,
save_restore: so I'm just going to start with '/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/autosave/iocEC-DAN-PCF0SYSM.sav0'.
save_restore: Trying backup file '/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/autosave/iocEC-DAN-PCF0SYSM.sav0'
save_restore: Can't open file '/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/autosave/iocEC-DAN-PCF0SYSM.sav0'.
save_restore: Trying backup file '/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/autosave/iocEC-DAN-PCF0SYSM.sav1'
save_restore: Can't open file '/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/autosave/iocEC-DAN-PCF0SYSM.sav1'.
save_restore: Trying backup file '/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/autosave/iocEC-DAN-PCF0SYSM.sav2'
save_restore: Can't open file '/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/autosave/iocEC-DAN-PCF0SYSM.sav2'.
save_restore: Can't find a file to restore from...save_restore: ...last tried '/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/autosave/iocEC-DAN-PCF0SYSM.sav2'. I give up.
save_restore: **********************************

save_restore: Can't open save file.cas warning: Configured TCP port was unavailable.
cas warning: Using dynamically assigned TCP port 35123,
cas warning: but now two or more servers share the same UDP port.
cas warning: Depending on your IP kernel this server may not be
cas warning: reachable with UDP unicast (a host's IP in EPICS_CA_ADDR_LIST)
iocRun: All initialization complete
< "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/target/main/epics/iocBoot/iocEC-DAN-PCF0SYSM/iocEC-DAN-PCF0SYSM-postSaveRestore.cmd"
############################################################################
## Autosave monitor post setup
############################################################################
cd "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/target/main/epics/iocBoot/iocEC-DAN-PCF0SYSM"
create_monitor_set("iocEC-DAN-PCF0SYSM.req",30,"P=EC-DAN-SYSM:F0SYSM-")
#- End-of-file marker - do not delete or add lines below!
< "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/target/main/epics/iocBoot/iocEC-DAN-PCF0SYSM/sddSeqToLoad.cmd"
############################################################################
## SDD provided sequence programs to load
############################################################################
#- End-of-file marker - do not delete or add lines below!
iocEC-DAN-PCF0SYSM.sav: 0 of 0 PV's connected
< "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/target/main/epics/iocBoot/iocEC-DAN-PCF0SYSM/seqToLoad.cmd"
############################################################################
## Sequence programs to load
############################################################################
## Start any sequence programs
#seq sncxxx,"user=andreaHost"
#- End-of-file marker - do not delete or add lines below!
< "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/target/main/epics/iocBoot/iocEC-DAN-PCF0SYSM/sddPostDriverConf.cmd"
############################################################################
## SDD provided PLC or fast controller driver post configuration
############################################################################
#- End-of-file marker - do not delete or add lines below!
< "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/target/main/epics/iocBoot/iocEC-DAN-PCF0SYSM/userPostDriverConf.cmd"
############################################################################
## User provided PLC or fast controller driver post configuration
############################################################################
#- End-of-file marker - do not delete or add lines below!
dbl > "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/iocdump//EC-DAN-PCF0SYSM-2018-01-10T11:54:35.dbl"
dbior > "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/iocdump//EC-DAN-PCF0SYSM-2018-01-10T11:54:35.dbior"
dbhcr > "/home/andrea/devel/codac/dan-tests/codac/units/m-DAN-sample/var/iocdump//EC-DAN-PCF0SYSM-2018-01-10T11:54:35.dbhcr"
#- End-of-file marker - do not delete or add lines below!
iocEC-DAN-PCF0SYSM> 